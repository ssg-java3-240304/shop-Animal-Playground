<!DOCTYPE html>
<!--여기 수정 -->
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>주문 및 매출 정보</title>
    <style>
        .info {
            display: inline-block;
            margin-right: 20px;
        }
        .container {
            margin-top: 20px;
        }
        .table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px; /* 테이블 간 간격 */
        }
        .table th, .table td {
            border: 1px solid #ddd;
            padding: 8px;
        }
        .table th {
            padding-top: 12px;
            padding-bottom: 12px;
            text-align: left;
            background-color: #f2f2f2;
        }
        .inner-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px; /* 내부 테이블 위쪽 간격 */
        }
        .inner-table th, .inner-table td {
            border: 1px solid #ddd;
            padding: 8px;
        }
        .inner-table th {
            background-color: #f9f9f9;
        }
    </style>
</head>
<body>
<div>
    <span th:object="${salesDto}" class="info">
        <p th:text="|총 주문 수: ${salesDto.count}건|"></p>
    </span>
    <span th:object="${salesDto}" class="info">
        <p th:text="|총 매출: ${#numbers.formatInteger(salesDto.sales, 3, 'COMMA')}원|"></p>
    </span>
</div>

<div class="container">
    <h1>주문 내역 출력</h1>
    <table class="table">
        <thead>
        <tr>
            <th>주문 번호</th>
            <th>고객 번호</th>
            <th>주문 일시</th>
            <th>주문 상태</th>
            <th>주문 가격</th>
            <th>상품 번호</th>
            <th>주문한 상품 개수</th>
            <th>상품 이름</th>
            <th>상품 가격</th>
        </tr>
        </thead>
        <tbody>
<!--  구조 수정 필요      -->
        <tr th:each="orderDetail : ${orderDetailDtos}">
            <td th:text="${orderDetail.orderId}" rowspan="${#lists.size(orderDetail.products) + 1}"></td>
            <td th:text="${orderDetail.userId}" rowspan="${#lists.size(orderDetail.products) + 1}"></td>
            <td th:text="${orderDetail.orderDate}" rowspan="${#lists.size(orderDetail.products) + 1}"></td>
            <td th:text="${orderDetail.orderStatus}" rowspan="${#lists.size(orderDetail.products) + 1}"></td>
            <td th:text="${#numbers.formatInteger(orderDetail.totalPrice, 3, 'COMMA')}" rowspan="${#lists.size(orderDetail.products) + 1}"></td>
            <td colspan="4">
                <table class="inner-table">
                    <thead>
                    <tr>
                        <th></th>
                        <th></th>
                        <th></th>
                        <th></th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr th:each="product : ${orderDetail.products}">
                        <td th:text="${product.productId}"></td>
                        <td th:text="${product.quantity}"></td>
                        <td th:text="${product.productName}"></td>
                        <td th:text="${product.productPrice}"></td>
                    </tr>
                    </tbody>
                </table>
            </td>
        </tr>
        </tbody>
    </table>
</div>
</body>
</html>

