<!DOCTYPE html>
<html lang="en"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout/default}">
<head>
    <meta charset="UTF-8">
    <title>회원 조회</title>
    <link rel="stylesheet">
</head>
<body>
<main layout:fragment="main">
    <h2 class="m-3">회원 조회</h2>

    <form action="#" th:action="@{/user/findByEmailAble}" method="get">
        <label for="userEmailAble">이메일 수신 동의 여부:</label>
        <select id="userEmailAble" name="userEmailAble">
            <option value="1">Yes</option>
            <option value="0">No</option>
        </select>
        <button type="submit">검색</button>
    </form>

    <h2 class="m-3">검색 결과</h2>
    <form th:action="@{/user/sendEmails}" method="post">
        <button type="submit">이메일 보내기</button>
        <table class="table">
            <thead>
            <tr>
                <th><input type="checkbox" id="selectAll" onclick="toggle(this)"></th>
                <th>회원 번호</th>
                <th>회원 이름</th>
                <th>회원 이메일</th>
                <th>회원 주소</th>
                <th>반려동물</th>
                <th>이메일 수신 동의</th>
                <th>가입 날짜</th>
                <th>마지막 접속 날짜</th>
                <th>휴면계정 여부</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="user : ${users}">
                <td><input type="checkbox" name="selectedUsers" th:value="${user.userId}"></td>
                <td th:text="${user.userId}"></td>
                <td th:text="${user.userName}"></td>
                <td th:text="${user.userEmail}"></td>
                <td th:text="${user.address}"></td>
                <td th:text="${user.userPet}"></td>
                <td th:text="${user.userEmailAble}"></td>
                <td th:text="${user.joinDate}"></td>
                <td th:text="${user.lastConnect}"></td>
                <td th:text="${user.dormantUser}"></td>
            </tr>
            </tbody>
        </table>

    </form>

    <script>
        function toggle(source) {
            checkboxes = document.getElementsByName('selectedUsers');
            for (var i = 0; i < checkboxes.length; i++) {
                checkboxes[i].checked = source.checked;
            }
        }
    </script>
</main>
</body>
</html>
